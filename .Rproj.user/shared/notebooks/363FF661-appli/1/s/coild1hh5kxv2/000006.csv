"0","  "
"0","  df_stat_by_province <- world_province %>%"
"0","    filter(country_region != 'Others') %>%"
"0","    group_by(country_region, province_state) %>%"
"0","    summarise(cum_confirmed = max(confirmed),"
"0","              cum_deaths = max(deaths),"
"0","              cum_recovered = max(recovered)) %>%"
"0","    mutate(death_rate = round(cum_deaths/(cum_confirmed + cum_recovered + cum_deaths), 3)) %>%"
"0","    left_join(world %>%"
"0","                select(country_region, province_state, lat, long)) %>%"
"0","    unique() %>%"
"0","    ungroup()"
"2","Joining, by = c(""country_region"", ""province_state"")
"
"0","  "
"0","  df_stat_by_province$id <- seq(nrow(df_stat_by_province))    "
"0","  "
"0","  df_stat_by_province$mean_incre_confirmed <- world_province %>%"
"0","    filter(country_region != 'Others') %>%"
"0","    group_by(country_region, province_state) %>%"
"0","    summarise(mean_incre_confirmed = round((sort(confirmed, decreasing = T)[1] - sort(confirmed, decreasing = T)[4])/3, 1)) %>%"
"0","    as.data.frame() %>%"
"0","    select(mean_incre_confirmed) %>%"
"0","    unlist()"
"0","  "
"0","  province_confirmed_plot <- df_stat_by_province %>%"
"0","    arrange(-mean_incre_confirmed) %>%"
"0","    head(10) %>%"
"0","    ggplot(aes(reorder(paste(country_region, '/', province_state), mean_incre_confirmed), mean_incre_confirmed)) +"
"0","    geom_bar(stat = 'identity', fill = 'orange', colour = 'orange', alpha = 0.75, size = 1) +"
"0","    scale_y_continuous(label = comma) +"
"0","    labs(x = '', y = '',"
"0","         title = 'Recent Mean Increased \nNum. of Confirmed') +"
"0","    coord_flip()"
"0","  "
"0","  province_death_rate_plot <- df_stat_by_province %>%"
"0","    arrange(-death_rate) %>%"
"0","    head(10) %>%"
"0","    ggplot(aes(reorder(paste(country_region, '/', province_state), death_rate), death_rate)) +"
"0","    geom_bar(stat = 'identity', fill = 'red', colour = 'red', alpha = 0.75, size = 1) +"
"0","    scale_y_continuous(label = percent_format(accuracy = 1)) +"
"0","    labs(x = '', y = '',"
"0","         title = 'Death Rate') +"
"0","    coord_flip()"
"0","  "
"0","  grid.arrange(province_confirmed_plot, province_death_rate_plot, ncol = 1)"
